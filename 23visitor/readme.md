### 🔹 概念

访问者模式 的核心思想是：
把 数据结构 和 对数据的操作 分离，通过引入 访问者对象，让你可以在不修改数据结构的情况下，为其增加新的操作。

简单理解：

* 数据结构（元素类）是“房子”

* 访问者是“客人”

* 不同的客人到房子里做不同的事情（打印、统计、导出……）

* 如果要增加新功能，只需要增加一个新访问者，而不用改原来的类

### 🔹 角色

1. Element（元素接口）：声明 Accept(visitor Visitor) 方法

2. ConcreteElement（具体元素）：实现 Accept，把自己传给访问者

3. Visitor（访问者接口）：声明对不同元素的访问方法

4. ConcreteVisitor（具体访问者）：实现具体的操作逻辑

5. ObjectStructure（对象结构）：保存元素集合，提供让访问者访问的入口

### 🔹 应用场景

* 编译器（语法树 + 不同的语义分析/优化/代码生成访问者）

* 文件系统（文件/目录 + 打印/统计/打包/加密访问者）

* 报表系统（数据对象 + 导出Excel/导出PDF访问者）

### 🔹 UML 

```javascript
                  ┌───────────────────────┐
                  │      Visitor          │<<interface>>
                  │-----------------------│
                  │+ visitConcreteA(a:ConcreteElementA) │
                  │+ visitConcreteB(b:ConcreteElementB) │
                  └────────────▲───────────┘
                               │
       ┌───────────────────────┼───────────────────────┐
       │                                               │
┌───────────────────────────┐                ┌───────────────────────────┐
│ ConcreteVisitor1           │                │ ConcreteVisitor2         │
│---------------------------│                │---------------------------│
│+ visitConcreteA(...)      │                │+ visitConcreteA(...)      │
│+ visitConcreteB(...)      │                │+ visitConcreteB(...)      │
└───────────────────────────┘                └───────────────────────────┘


                  ┌───────────────────────┐
                  │     Element           │<<interface>>
                  │-----------------------│
                  │+ accept(v:Visitor)    │
                  └────────────▲───────────┘
                               │
       ┌───────────────────────┼───────────────────────┐
       │                                               │
┌───────────────────────────┐                ┌───────────────────────────┐
│ ConcreteElementA           │                │ ConcreteElementB         │
│---------------------------│                │---------------------------│
│+ accept(v:Visitor)        │                │+ accept(v:Visitor)        │
└───────────────────────────┘                └───────────────────────────┘

                  ┌───────────────────────┐
                  │       ObjectStructure │
                  │-----------------------│
                  │- elements: List<Element>│
                  │+ accept(v:Visitor)    │
                  └───────────────────────┘

```