### 🔹 概念

享元模式 的核心思想是：共享对象，避免大量相同对象的重复创建，从而节省内存和提升性能。

适用场景：

* 有大量相似对象，需要缓存/复用

* 对象内部有 不变的共享部分（内部状态） 和 依赖外部的可变部分（外部状态）

### 🔹 角色

1. Flyweight（享元对象）：可共享的对象，包含内部状态

2. ConcreteFlyweight（具体享元）：具体的实现类

3. FlyweightFactory（享元工厂）：管理共享池，确保相同对象只创建一次

4. Client（客户端）：使用享元对象，传入外部状态

### 🔹 总结
* 共享内部状态（如棋子颜色）

* 外部状态由客户端维护（如位置）

* 享元工厂 保证同一类对象只会被创建一次并复用


### 🔹 UML 

```javascript
                ┌───────────────────────┐
                │      Flyweight        │<<interface>>
                │-----------------------│
                │+ operation(extrinsic) │
                └───────────▲───────────┘
                            │
        ┌───────────────────┼───────────────────┐
        │                                       │
┌────────────────────┐                 ┌──────────────────────┐
│ ConcreteFlyweight  │                 │ UnsharedFlyweight    │
│--------------------│                 │----------------------│
│- intrinsicState    │                 │- allState            │
│+ operation(extr.)  │                 │+ operation(extr.)    │
└────────────────────┘                 └──────────────────────┘

                 ┌────────────────────────┐
                 │    FlyweightFactory    │
                 │------------------------│
                 │- pool: Map<Key,Flyw>   │
                 │+ getFlyweight(key):Fly │
                 └────────────────────────┘

```